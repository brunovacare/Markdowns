# OpenAPI Generator

* Main website [here](https://openapi-generator.tech/).

* Ao executar o **SpringDoc** no Java ou o **NSwag** no dotnet para gerar o yaml com as APis, é importante especificar o operationID para cada método gerado. O operationID deve ser único e deve conter o nome da classe. Ex no SpringDoc: 

  ```java
  @Operation(operationId = "AttachmentController.saveAttachment", summary = "Saves the attachment", description = "Saves the file in our system")
  ```

* OpenAPI Generator will discard "AttachmentController" when creating the method call for the client side. Only "saveAttachment" will be used in the example above. **Always** write the className in your operationId, or you might get methods like `save(), save_1(), save_2()`. 

# Angular

Passo a passo para criar um projeto Angular com integração com OpenAPI Generator (alternativa ao Swagger Code Gen). 

Há um exemplo illustrativo [aqui](https://github.com/OpenAPITools/openapi-generator/tree/master/samples/client/petstore)

1. Instalar a linha de comando do Open API Generator: `npm install @openapitools/openapi-generator-cli -g`
1. Criar um workspace Angular: `ng new my-workspace --createApplication="false"`
1. Criar o projeto Angular: `cd my-workspace, ng generate application my-first-app`
1. Utilizar Angular Routing e SCSS ao ser questionado pelo `ng`. 
1. O projeto `my-first-app` é criado dentro da pasta projects. 
1. Criar uma lib para o Open API Generator: `ng generate library openapigenerator`
1. Remover todo conteúdo da pasta src do projeto openapigenerator.
1. Executar o openapi para gerar o código a partir do openapi. Ex: `openapi-generator generate -i api.yaml -g typescript-angular -o ./openapigenerator --additional-properties="ngVersion=8.2.14"`
1. Copiar o conteúdo gerado DENTRO da pasta openapigenerator para DENTRO da pasta src do projeto Angular openapigenerator.
1. Importar o módulo da lib openapigenerator no seu projeto -my-first-app. Para isso, edite o arquivo app.module.ts da seguinte maneira: 

```typescript
import { Configuration, ConfigurationParameters } from './../../../swagger/src/configuration';
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
import { AppRoutingModule } from './app-routing.module';
import { AppComponent } from './app.component';
import { HttpClientModule } from '@angular/common/http';
import { ApiModule, BASE_PATH } from 'projects/openapigenerator/src';

function apiConfigFactory (): Configuration  {
  const params: ConfigurationParameters = {
    // set configuration parameters here.
  }
  return new Configuration(params);
}

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule,
    HttpClientModule,
    ApiModule.forRoot(apiConfigFactory)
  ],
  providers: [{provide: BASE_PATH, useValue: 'https://your-web-service.com'}],
  bootstrap: [AppComponent]
})
export class AppModule { }
```

1. Repare que é possível especificar as credenciais JWT, entre outros na função apiConfigFactory. 
1. Agora já é possível acessar as apis. Segue um exemplo abaixo:

```typescript
import { Component, OnInit } from '@angular/core';
import { DefaultService } from 'projects/openapigenerator/src';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.scss']
})
export class AppComponent implements OnInit {
  constructor(private apiGateway: DefaultService){
  }

  async ngOnInit(){
    let result= await this.apiGateway.getProducts().toPromise();
  }
}
```

Follow a sample script to download the API generated by SpringDoc and generate all typescript calls below:

```shell
curl http://yourwebsite.com/v3/api-docs -o api.json
rEM curl http://localhost:9090/v3/api-docs -o api.json
openapi-generator generate -i api.json  -g typescript-angular  -o ./projects/apiproject  --additional-properties="ngVersion=8.2.14" --import-mappings=Date=java.sql.Date --type-mappings=Date=string
```

# Flutter

* openapi-generator generate --input-spec swagger.json -g dart --output api --additional-properties=disallowAdditionalPropertiesIfNotPresent=false,pubName=pocapi

